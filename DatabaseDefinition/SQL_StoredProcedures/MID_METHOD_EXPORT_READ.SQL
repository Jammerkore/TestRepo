--dv =============================================
--dv Create date:	12/10/2013
--dv Description:	Reads rows from the method export
--dv =============================================
CREATE PROCEDURE [dbo].[MID_METHOD_EXPORT_READ]
	@METHOD_RID int
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @NoRID int = -1;
	DECLARE @ePlanType_Chain int = 0;
	DECLARE @eLowLevelsType_None int = 0;
	DECLARE @eExportType_XML int = 1;
	DECLARE @eExportDateType_Calendar int = 0;
	DECLARE @eExportSplitType_None int = 0;

	SELECT 
		COALESCE(HN_RID, @NoRID) HN_RID,
		COALESCE(FV_RID, @NoRID) FV_RID,
		COALESCE(CDR_RID, @NoRID) CDR_RID,
		COALESCE(STORE_FILTER_RID, @NoRID) STORE_FILTER_RID,
		COALESCE(PLAN_TYPE, @ePlanType_Chain) PLAN_TYPE,
		COALESCE(LOW_LEVELS_IND, '0') LOW_LEVELS_IND,
		COALESCE(LOW_LEVELS_ONLY_IND, '0') LOW_LEVELS_ONLY_IND,
		COALESCE(LOW_LEVELS_TYPE, @eLowLevelsType_None) LOW_LEVELS_TYPE,
		COALESCE(LOW_LEVEL_SEQUENCE, @NoRID) LOW_LEVEL_SEQUENCE,
		COALESCE(LOW_LEVEL_OFFSET, @NoRID) LOW_LEVEL_OFFSET,
		COALESCE(SHOW_INELIGIBLE_IND, '0') SHOW_INELIGIBLE_IND,
		COALESCE(USE_DEFAULT_SETTINGS_IND, '0') USE_DEFAULT_SETTINGS_IND,
		COALESCE(EXPORT_TYPE, @eExportType_XML) EXPORT_TYPE,
		COALESCE(DELIMETER, '') DELIMETER,
		COALESCE(CSV_FILE_EXTENSION, '') CSV_FILE_EXTENSION,
		COALESCE(DATE_TYPE, @eExportDateType_Calendar) DATE_TYPE,
		COALESCE(PREINIT_VALUES_IND, '0') PREINIT_VALUES_IND,
		COALESCE(EXCLUDE_ZERO_VALUES_IND, '0') EXCLUDE_ZERO_VALUES_IND,
		COALESCE(FILE_PATH, '') FILE_PATH,
		COALESCE(ADD_DATE_STAMP_IND, '0') ADD_DATE_STAMP_IND,
		COALESCE(ADD_TIME_STAMP_IND, '0') ADD_TIME_STAMP_IND,
		COALESCE(SPLIT_TYPE, @eExportSplitType_None) SPLIT_TYPE,
		COALESCE(SPLIT_NUM_ENTRIES, @NoRID) SPLIT_NUM_ENTRIES,
		COALESCE(CONCURRENT_PROCESSES, @NoRID) CONCURRENT_PROCESSES,
		COALESCE(CREATE_FLAG_FILE_IND, '0') CREATE_FLAG_FILE_IND,
		COALESCE(FLAG_FILE_EXTENSION, '') FLAG_FILE_EXTENSION,
		COALESCE(CREATE_END_FILE_IND, '0') CREATE_END_FILE_IND,
		COALESCE(END_FILE_EXTENSION, '') END_FILE_EXTENSION, 
		COALESCE(OLL_RID, @NoRID) OLL_RID 
		FROM METHOD_EXPORT 
		WHERE METHOD_RID = @METHOD_RID

END
GO