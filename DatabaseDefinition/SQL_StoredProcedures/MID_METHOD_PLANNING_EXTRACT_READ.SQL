--dv =============================================
--dv Create date:	2/23/2018
--dv Description:	Reads rows from the method export
--dv =============================================
CREATE PROCEDURE [dbo].[MID_METHOD_PLANNING_EXTRACT_READ]
	@METHOD_RID int
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @NoRID int = -1;
	DECLARE @ePlanType_Chain int = 0;
	DECLARE @eLowLevelsType_None int = 0;
	DECLARE @eExportType_XML int = 1;
	DECLARE @eExportDateType_Calendar int = 0;
	DECLARE @eExportSplitType_None int = 0;

	SELECT 
		COALESCE(HN_RID, @NoRID) HN_RID,
		COALESCE(FV_RID, @NoRID) FV_RID,
		COALESCE(CDR_RID, @NoRID) CDR_RID,
		COALESCE(STORE_FILTER_RID, @NoRID) STORE_FILTER_RID,
		COALESCE(CHAIN_IND, '0') CHAIN_IND,
		COALESCE(STORE_IND, '0')STORE_IND,
		COALESCE(ATTRIBUTE_SET_IND, '0') ATTRIBUTE_SET_IND,
		COALESCE(ATTRIBUTE_RID, @NoRID) ATTRIBUTE_RID,
		COALESCE(LOW_LEVELS_IND, '0') LOW_LEVELS_IND,
		COALESCE(LOW_LEVELS_ONLY_IND, '0') LOW_LEVELS_ONLY_IND,
		COALESCE(LOW_LEVELS_TYPE, @eLowLevelsType_None) LOW_LEVELS_TYPE,
		COALESCE(LOW_LEVEL_SEQUENCE, @NoRID) LOW_LEVEL_SEQUENCE,
		COALESCE(LOW_LEVEL_OFFSET, @NoRID) LOW_LEVEL_OFFSET,
		COALESCE(SHOW_INELIGIBLE_IND, '0') SHOW_INELIGIBLE_IND,
		COALESCE(EXCLUDE_ZERO_VALUES_IND, '0') EXCLUDE_ZERO_VALUES_IND,
		COALESCE(CONCURRENT_PROCESSES, @NoRID) CONCURRENT_PROCESSES,
		COALESCE(OLL_RID, @NoRID) OLL_RID,
		UPDATE_DATE,
	        EXTRACT_DATE
		FROM METHOD_PLANNING_EXTRACT 
		WHERE METHOD_RID = @METHOD_RID

END
GO