CREATE PROCEDURE [dbo].[SP_MID_SCHEDULE_INSERT] 
	(
	--Begin TT#1430 - JScott - Long Tasklist Name causes duplicate key on JOB table
	--	@SCHED_NAME VARCHAR(50),
	@SCHED_NAME VARCHAR(100),
	--End TT#1430 - JScott - Long Tasklist Name causes duplicate key on JOB table
	@START_TIME DATETIME,
	@SCHEDULE_BY_TYPE INT,
	@SCHEDULE_BY_INTERVAL INT,
	@SCHEDULE_ON_MONDAY_IND CHAR,
	@SCHEDULE_ON_TUESDAY_IND CHAR,
	@SCHEDULE_ON_WEDNESDAY_IND CHAR,
	@SCHEDULE_ON_THURSDAY_IND CHAR,
	@SCHEDULE_ON_FRIDAY_IND CHAR,
	@SCHEDULE_ON_SATURDAY_IND CHAR,
	@SCHEDULE_ON_SUNDAY_IND CHAR,
	@SCHEDULE_BY_MONTH_WEEK_TYPE INT,
	@START_DATE_RANGE DATETIME,
	@END_DATE_IND CHAR,
	@END_DATE_RANGE DATETIME,
	@REPEAT_INTERVAL INT,
	@REPEAT_INTERVAL_TYPE INT,
	@REPEAT_UNTIL_IND CHAR,
	@REPEAT_UNTIL_TIME DATETIME,
	@REPEAT_DURATION_IND CHAR,
	@REPEAT_DURATION_HOURS INT,
	@REPEAT_DURATION_MINUTES INT,
	@CONDITION_TYPE INT,
	@CONDITION_TRIGGER_DIRECTORY VARCHAR(50),
	@CONDITION_TRIGGER_SUFFIX VARCHAR(10),
	@TERMINATE_AFTER_COND_MET_IND CHAR,
	@REPEAT_UNTIL_SUCCESSFUL_IND CHAR,
	@CREATED_BY_USER_RID INT,
	@CREATED_DATETIME DATETIME,
	@LAST_MODIFIED_BY_USER_RID INT,
	@LAST_MODIFIED_DATETIME DATETIME,
	@SCHED_RID INT OUTPUT
	)
AS
BEGIN
	SET NOCOUNT ON

	INSERT INTO SCHEDULE (
		SCHED_NAME,
		START_TIME,
		SCHEDULE_BY_TYPE,
		SCHEDULE_BY_INTERVAL,
		SCHEDULE_ON_MONDAY_IND,
		SCHEDULE_ON_TUESDAY_IND,
		SCHEDULE_ON_WEDNESDAY_IND,
		SCHEDULE_ON_THURSDAY_IND,
		SCHEDULE_ON_FRIDAY_IND,
		SCHEDULE_ON_SATURDAY_IND,
		SCHEDULE_ON_SUNDAY_IND,
		SCHEDULE_BY_MONTH_WEEK_TYPE,
		START_DATE_RANGE,
		END_DATE_IND,
		END_DATE_RANGE,
		REPEAT_INTERVAL,
		REPEAT_INTERVAL_TYPE,
		REPEAT_UNTIL_IND,
		REPEAT_UNTIL_TIME,
		REPEAT_DURATION_IND,
		REPEAT_DURATION_HOURS,
		REPEAT_DURATION_MINUTES,
		CONDITION_TYPE,
		CONDITION_TRIGGER_DIRECTORY,
		CONDITION_TRIGGER_SUFFIX,
		TERMINATE_AFTER_COND_MET_IND,
		REPEAT_UNTIL_SUCCESSFUL_IND,
		CREATED_BY_USER_RID,
		CREATED_DATETIME
		)
	VALUES (
		@SCHED_NAME,
		@START_TIME,
		@SCHEDULE_BY_TYPE,
		@SCHEDULE_BY_INTERVAL,
		@SCHEDULE_ON_MONDAY_IND,
		@SCHEDULE_ON_TUESDAY_IND,
		@SCHEDULE_ON_WEDNESDAY_IND,
		@SCHEDULE_ON_THURSDAY_IND,
		@SCHEDULE_ON_FRIDAY_IND,
		@SCHEDULE_ON_SATURDAY_IND,
		@SCHEDULE_ON_SUNDAY_IND,
		@SCHEDULE_BY_MONTH_WEEK_TYPE,
		@START_DATE_RANGE,
		@END_DATE_IND,
		@END_DATE_RANGE,
		@REPEAT_INTERVAL,
		@REPEAT_INTERVAL_TYPE,
		@REPEAT_UNTIL_IND,
		@REPEAT_UNTIL_TIME,
		@REPEAT_DURATION_IND,
		@REPEAT_DURATION_HOURS,
		@REPEAT_DURATION_MINUTES,
		@CONDITION_TYPE,
		@CONDITION_TRIGGER_DIRECTORY,
		@CONDITION_TRIGGER_SUFFIX,
		@TERMINATE_AFTER_COND_MET_IND,
		@REPEAT_UNTIL_SUCCESSFUL_IND,
		@CREATED_BY_USER_RID,
		@CREATED_DATETIME
		)

	SELECT @SCHED_RID = SCOPE_IDENTITY() -- TT#3256 - JSmith - Replace @@IDENTITY with SCOPE_IDENTITY()
END
GO


