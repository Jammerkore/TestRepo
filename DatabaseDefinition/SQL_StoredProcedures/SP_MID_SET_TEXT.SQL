CREATE PROCEDURE [dbo].[SP_MID_SET_TEXT] 
	@TEXT_CODE INT,
	@TEXT_VALUE VARCHAR(250),
	@TEXT_MAX_LENGTH INT,
	@TEXT_TYPE INT,
	@TEXT_LEVEL INT,
	@TEXT_VALUE_TYPE INT,
	@TEXT_ORDER INT,
	@TEXT_UPDATE BIT = 0
AS
BEGIN
	DECLARE @myCount INT

	SELECT @myCount = count(*)
	FROM APPLICATION_TEXT
	WHERE TEXT_CODE = @TEXT_CODE

	IF @myCount = 0
	BEGIN
		INSERT INTO APPLICATION_TEXT (
			TEXT_CODE,
			TEXT_VALUE,
			TEXT_MAX_LENGTH,
			TEXT_TYPE,
			TEXT_LEVEL,
			TEXT_VALUE_TYPE,
			TEXT_ORDER
			)
		VALUES (
			@TEXT_CODE,
			@TEXT_VALUE,
			@TEXT_MAX_LENGTH,
			@TEXT_TYPE,
			@TEXT_LEVEL,
			@TEXT_VALUE_TYPE,
			@TEXT_ORDER
			)
	END
	ELSE IF @TEXT_UPDATE = 1
	BEGIN
		UPDATE APPLICATION_TEXT
		SET TEXT_VALUE = @TEXT_VALUE,
			TEXT_MAX_LENGTH = @TEXT_MAX_LENGTH,
			TEXT_TYPE = @TEXT_TYPE,
			TEXT_LEVEL = @TEXT_LEVEL,
			TEXT_VALUE_TYPE = @TEXT_VALUE_TYPE,
			TEXT_ORDER = @TEXT_ORDER
		WHERE TEXT_CODE = @TEXT_CODE
	END
	SELECT @@ROWCOUNT
END
GO


