--dv =============================================
--dv Create date:	2/11/2014
--dv Description:	Reads Size Curves 
--dv =============================================
CREATE PROCEDURE [dbo].[MID_SIZE_CURVE_READ]
	@SIZE_CURVE_RID int,
	@SIZE_CODE_SECONDARY varchar(100)
AS
BEGIN
	SET NOCOUNT ON;

	SELECT 
		SC.SIZE_CURVE_RID, 
		SIZE_CURVE_NAME, 
		CD.SIZE_CODE_RID, 
		0 SEQ, 
		CD.SIZE_CODE_ID, 
		COALESCE([PERCENT],0) [PERCENT],
		CD.SIZE_CODE_PRIMARY, 
		COALESCE(CD.SIZE_CODE_SECONDARY, @SIZE_CODE_SECONDARY) as SIZE_CODE_SECONDARY, 
		CD.SIZE_CODE_PRODUCT_CATEGORY,
		SZ.SIZES_RID, COALESCE(DIM.DIMENSIONS_RID, -1) DIMENSIONS_RID
    FROM SIZES SZ, 
		SIZE_CURVE SC 
		LEFT OUTER JOIN SIZE_CURVE_JOIN SCJ on SC.SIZE_CURVE_RID = SCJ.SIZE_CURVE_RID 
		LEFT OUTER JOIN SIZE_CODE CD on SCJ.SIZE_CODE_RID = CD.SIZE_CODE_RID LEFT OUTER JOIN DIMENSIONS DIM ON CD.SIZE_CODE_SECONDARY = DIM.SIZE_CODE_SECONDARY
    WHERE SC.SIZE_CURVE_RID = @SIZE_CURVE_RID
		and CD.SIZE_CODE_PRIMARY = SZ.SIZE_CODE_PRIMARY	
	ORDER BY CD.SIZE_CODE_PRIMARY, 
			 CD.SIZE_CODE_SECONDARY
END
GO