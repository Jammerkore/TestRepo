--dv =============================================
--dv Create date: 12/23/2013
--dv Description: Get store group level updated by ID.
--dv =============================================
CREATE PROCEDURE [dbo].[MID_STORE_GROUP_LEVEL_UPDATE_ID] 
	@SGL_RID INT,
	@SGL_VERSION INT,
	@SGL_ID VARCHAR(50),
	@UPDATE_STORE_GROUP_LEVEL_IND CHAR
AS
BEGIN
	SET NOCOUNT ON;

	IF (@UPDATE_STORE_GROUP_LEVEL_IND = '1')
	BEGIN
		UPDATE STORE_GROUP_LEVEL
		SET SGL_ID = @SGL_ID
		WHERE SGL_RID = @SGL_RID
	END

	DECLARE @SGL_CUR_VERSION INT;
	SELECT @SGL_CUR_VERSION=sgl.SGL_VERSION FROM STORE_GROUP_LEVEL sgl WHERE sgl.SGL_RID=@SGL_RID;

	IF (@SGL_VERSION=@SGL_CUR_VERSION)
	BEGIN
		UPDATE STORE_GROUP_JOIN
		SET SGL_OVERRIDE_ID = @SGL_ID
		WHERE SGL_RID = @SGL_RID AND SGL_VERSION=@SGL_VERSION
	END
	ELSE
	BEGIN
		UPDATE STORE_GROUP_JOIN_HISTORY
		SET SGL_OVERRIDE_ID = @SGL_ID
		WHERE SGL_RID = @SGL_RID AND SGL_VERSION=@SGL_VERSION
	END


	SELECT @@ROWCOUNT
END
GO