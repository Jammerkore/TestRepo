--dv =============================================
--dv Create date:	2/11/2014
--dv Description:	Updates a schedule job join
--dv =============================================
CREATE PROCEDURE [dbo].[MID_SCHEDULE_JOB_JOIN_UPDATE]
	@SCHED_RID int, 
	@JOB_RID int, 
	@USER_RID int, 
	@EXECUTION_STATUS int, 
	@LAST_COMPLETION_STATUS int, 
	@LAST_RUN_DATETIME datetime, 
	@LAST_COMPLETION_DATETIME datetime,
	@NEXT_RUN_DATETIME datetime, 
	@REPEAT_UNTIL_DATETIME datetime,
	@HOLD_BY_USER_RID int,
	@HOLD_BY_DATETIME datetime,
	@RELEASED_BY_USER_RID int,
	@RELEASED_BY_DATETIME datetime
AS
BEGIN
	SET NOCOUNT ON;
	
	UPDATE SCHEDULE_JOB_JOIN 
	SET
		USER_RID = @USER_RID,
		EXECUTION_STATUS = @EXECUTION_STATUS, 
		LAST_COMPLETION_STATUS = @LAST_COMPLETION_STATUS, 
		LAST_RUN_DATETIME = @LAST_RUN_DATETIME,
		LAST_COMPLETION_DATETIME = @LAST_COMPLETION_DATETIME,
		NEXT_RUN_DATETIME = @NEXT_RUN_DATETIME, 
		REPEAT_UNTIL_DATETIME = @REPEAT_UNTIL_DATETIME,
		HOLD_BY_USER_RID = @HOLD_BY_USER_RID,
		HOLD_BY_DATETIME = @HOLD_BY_DATETIME,
		RELEASED_BY_USER_RID = @RELEASED_BY_USER_RID,
		RELEASED_BY_DATETIME = @RELEASED_BY_DATETIME

	WHERE SCHED_RID = @SCHED_RID
		  AND JOB_RID = @JOB_RID

	SELECT @@ROWCOUNT;

END
GO