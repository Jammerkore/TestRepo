--dv =============================================
--dv Create date:	1/29/2014
--dv Description:	Reads a size group
--dv =============================================
CREATE PROCEDURE [dbo].[MID_SIZE_GROUP_READ]
	@SIZE_GROUP_RID int
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @lbl_NoSecondarySize INT = 900356;
	DECLARE @NoSizeDimensionLbl VARCHAR(100);
	SELECT @NoSizeDimensionLbl = TEXT_VALUE FROM APPLICATION_TEXT WHERE TEXT_CODE = @lbl_NoSecondarySize
	
	SELECT 
		SG.*, 
		SC.SIZE_CODE_RID, 
		SC.SIZE_CODE_ID, 
		SC.SIZE_CODE_PRIMARY,
		CASE WHEN SC.SIZE_CODE_SECONDARY IS NULL THEN @NoSizeDimensionLbl ELSE SC.SIZE_CODE_SECONDARY END AS SIZE_CODE_SECONDARY, 
		SC.SIZE_CODE_PRODUCT_CATEGORY, 
		SZ.SIZES_RID, 
		COALESCE(DIM.DIMENSIONS_RID, -1) DIMENSIONS_RID 
	FROM SIZE_GROUP SG, 
		 SIZE_GROUP_JOIN SGJ, 
		 SIZE_CODE SC 
		 LEFT OUTER JOIN DIMENSIONS DIM ON SC.SIZE_CODE_SECONDARY = DIM.SIZE_CODE_SECONDARY, 
		 SIZES SZ
	WHERE SG.SIZE_GROUP_RID = SGJ.SIZE_GROUP_RID and SGJ.SIZE_CODE_RID = SC.SIZE_CODE_RID
		  AND SC.SIZE_CODE_PRIMARY = SZ.SIZE_CODE_PRIMARY
		  AND SG.SIZE_GROUP_RID = @SIZE_GROUP_RID
	ORDER BY SEQ

END
GO

