--dv =============================================
--dv Create date: 02/11/2014
--dv Description: Update a users schedule.
--dv =============================================
CREATE PROCEDURE [dbo].[MID_SCHEDULE_UPDATE]
	@SCHED_NAME VARCHAR(100),
	@START_TIME DATETIME,
	@SCHEDULE_BY_TYPE INT,
	@SCHEDULE_BY_INTERVAL INT,
	@SCHEDULE_ON_MONDAY_IND CHAR(1),
	@SCHEDULE_ON_TUESDAY_IND CHAR(1),
	@SCHEDULE_ON_WEDNESDAY_IND CHAR(1),
	@SCHEDULE_ON_THURSDAY_IND CHAR(1),
	@SCHEDULE_ON_FRIDAY_IND CHAR(1),
	@SCHEDULE_ON_SATURDAY_IND CHAR(1),
	@SCHEDULE_ON_SUNDAY_IND CHAR(1),
	@SCHEDULE_BY_MONTH_WEEK_TYPE INT,
	@START_DATE_RANGE DATETIME,
	@END_DATE_IND CHAR(1),
	@END_DATE_RANGE DATETIME,
	@REPEAT_INTERVAL INT,
	@REPEAT_INTERVAL_TYPE INT,
	@REPEAT_UNTIL_IND CHAR(1),
	@REPEAT_UNTIL_TIME DATETIME,
	@REPEAT_DURATION_IND CHAR(1),
	@REPEAT_DURATION_HOURS INT,
	@REPEAT_DURATION_MINUTES INT,
	@CONDITION_TYPE INT,
	@CONDITION_TRIGGER_DIRECTORY VARCHAR(50),
	@CONDITION_TRIGGER_SUFFIX VARCHAR(50),
	@TERMINATE_AFTER_COND_MET_IND CHAR(1),
	@REPEAT_UNTIL_SUCCESSFUL_IND CHAR(1),
	@LAST_MODIFIED_BY_USER_RID INT,
	@LAST_MODIFIED_DATETIME DATETIME,
	@SCHED_RID INT
AS
BEGIN
	SET NOCOUNT ON;

	UPDATE SCHEDULE
	SET SCHED_NAME = @SCHED_NAME,
		START_TIME = @START_TIME,
		SCHEDULE_BY_TYPE = @SCHEDULE_BY_TYPE,
		SCHEDULE_BY_INTERVAL = @SCHEDULE_BY_INTERVAL,
		SCHEDULE_ON_MONDAY_IND = @SCHEDULE_ON_MONDAY_IND,
		SCHEDULE_ON_TUESDAY_IND = @SCHEDULE_ON_TUESDAY_IND,
		SCHEDULE_ON_WEDNESDAY_IND = @SCHEDULE_ON_WEDNESDAY_IND,
		SCHEDULE_ON_THURSDAY_IND = @SCHEDULE_ON_THURSDAY_IND,
		SCHEDULE_ON_FRIDAY_IND = @SCHEDULE_ON_FRIDAY_IND,
		SCHEDULE_ON_SATURDAY_IND = @SCHEDULE_ON_SATURDAY_IND,
		SCHEDULE_ON_SUNDAY_IND = @SCHEDULE_ON_SUNDAY_IND,
		SCHEDULE_BY_MONTH_WEEK_TYPE = @SCHEDULE_BY_MONTH_WEEK_TYPE,
		START_DATE_RANGE = @START_DATE_RANGE,
		END_DATE_IND = @END_DATE_IND,
		END_DATE_RANGE = @END_DATE_RANGE,
		REPEAT_INTERVAL = @REPEAT_INTERVAL,
		REPEAT_INTERVAL_TYPE = @REPEAT_INTERVAL_TYPE,
		REPEAT_UNTIL_IND = @REPEAT_UNTIL_IND,
		REPEAT_UNTIL_TIME = @REPEAT_UNTIL_TIME,
		REPEAT_DURATION_IND = @REPEAT_DURATION_IND,
		REPEAT_DURATION_HOURS = @REPEAT_DURATION_HOURS,
		REPEAT_DURATION_MINUTES = @REPEAT_DURATION_MINUTES,
		CONDITION_TYPE = @CONDITION_TYPE,
		CONDITION_TRIGGER_DIRECTORY = @CONDITION_TRIGGER_DIRECTORY,
		CONDITION_TRIGGER_SUFFIX = @CONDITION_TRIGGER_SUFFIX,
		TERMINATE_AFTER_COND_MET_IND = @TERMINATE_AFTER_COND_MET_IND,
		REPEAT_UNTIL_SUCCESSFUL_IND = @REPEAT_UNTIL_SUCCESSFUL_IND,
		LAST_MODIFIED_BY_USER_RID = @LAST_MODIFIED_BY_USER_RID,
		LAST_MODIFIED_DATETIME = @LAST_MODIFIED_DATETIME
	WHERE SCHED_RID = @SCHED_RID

	SELECT @@ROWCOUNT
END
GO


