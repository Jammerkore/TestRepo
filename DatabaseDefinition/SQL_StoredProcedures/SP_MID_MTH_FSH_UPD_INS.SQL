--dv =============================================
--dv Modified:		7/1/2004
--dv Description:	INSERTS OR UPDATES DATA IN METHOD_FILL_SIZE_HOLES 
--dv History:		TT#246-MD - AGallagher - VSW Size - Add In-store Size Constraint options 
--dv				6/15/2015 -TT#1636-MD -jsobek -Pre-Pack Fill Size
--dv =============================================
CREATE PROCEDURE [dbo].[SP_MID_MTH_FSH_UPD_INS] 
	(
	@METHODRID INT,
	@AVAILABLE FLOAT = NULL,
	@AVAILABLEIND CHAR(1) = NULL,
	@SIZEGROUPRID INT = NULL,
	@SIZECURVEGROUPRID INT = NULL,
	@MERCHTYPE INT = NULL,
	@MERCHHNRID INT = NULL,
	@MERCHPHRID INT = NULL,
	@MERCHPHLSEQ INT = NULL,
	@STOREFILTERRID INT = NULL,
	@SIZEALTERNATERID INT = NULL,
	@SIZECONSTRAINTRID INT = NULL,
	@GENCURVE_HCG_RID INT = NULL,
	@GENCURVE_HN_RID INT = NULL,
	@GENCURVE_PH_RID INT = NULL,
	@GENCURVE_PHL_SEQUENCE INT = NULL,
	@GENCURVE_COLOR_IND CHAR(1) = NULL,
	@GENCURVE_MERCH_TYPE INT = NULL,
	@GENCONSTRAINT_HCG_RID INT = NULL,
	@GENCONSTRAINT_HN_RID INT = NULL,
	@GENCONSTRAINT_PH_RID INT = NULL,
	@GENCONSTRAINT_PHL_SEQUENCE INT = NULL,
	@GENCONSTRAINT_COLOR_IND CHAR(1) = NULL,
	@GENCONSTRAINT_MERCH_TYPE INT = NULL,
	@NORMALIZE_SIZE_CURVES_IND CHAR(1) = NULL,
	@FILL_SIZES_TO_TYPE INT = NULL,
	@USE_DEFAULT_CURVE_IND CHAR(1) = NULL,
	@GENCURVE_NSCCD_RID INT = NULL, 
	@APPLY_RULES_ONLY_IND CHAR(1) = NULL, 
	@IB_MERCH_TYPE INT = NULL, 
	@IB_MERCH_HN_RID INT = NULL,
	@IB_MERCH_PH_RID INT = NULL,
	@IB_MERCH_PHL_SEQUENCE INT = NULL, 
	@VSW_SIZE_CONSTRAINTS_IND CHAR(1) = NULL,
	@VSW_SIZE_CONSTRAINTS INT = NULL, 
	@AVGPACKDEVIATION FLOAT = NULL,
	@MAXPACKNEED FLOAT = NULL,
	@OVERRIDE_AVG_PACK_DEV_IND CHAR(1) = NULL,
	@OVERRIDE_MAX_PACK_NEED_IND CHAR(1) = NULL,
	@PACK_TOLERANCE_NO_MAX_STEP_IND CHAR(1) = NULL,
	@PACK_TOLERANCE_STEPPED_IND CHAR(1) = NULL
	)
AS
BEGIN
	SET NOCOUNT ON
	SET ANSI_PADDING ON

	IF NOT EXISTS (
			SELECT *
			FROM METHOD_FILL_SIZE_HOLES
			WHERE METHOD_RID = @METHODRID
			)
		--INSERT
	BEGIN
		INSERT INTO METHOD_FILL_SIZE_HOLES (
			METHOD_RID,
			AVAILABLE,
			AVAILABLE_TYPE_IND,
			SIZE_GROUP_RID,
			SIZE_CURVE_GROUP_RID,
			MERCH_TYPE,
			MERCH_HN_RID,
			MERCH_PH_RID,
			MERCH_PHL_SEQUENCE,
			STORE_FILTER_RID,
			SIZE_ALTERNATE_RID,
			SIZE_CONSTRAINT_RID,
			GENCURVE_HCG_RID,
			GENCURVE_HN_RID,
			GENCURVE_PH_RID,
			GENCURVE_PHL_SEQUENCE,
			GENCURVE_COLOR_IND,
			GENCURVE_MERCH_TYPE,
			GENCONSTRAINT_HCG_RID,
			GENCONSTRAINT_HN_RID,
			GENCONSTRAINT_PH_RID,
			GENCONSTRAINT_PHL_SEQUENCE,
			GENCONSTRAINT_COLOR_IND,
			GENCONSTRAINT_MERCH_TYPE,
			NORMALIZE_SIZE_CURVES_IND,
			FILL_SIZES_TO_TYPE,
			USE_DEFAULT_CURVE_IND,
			GENCURVE_NSCCD_RID, 
			APPLY_RULES_ONLY_IND, 
			IB_MERCH_TYPE,
			IB_MERCH_HN_RID,
			IB_MERCH_PH_RID,
			IB_MERCH_PHL_SEQUENCE,
			VSW_SIZE_CONSTRAINTS_IND,
			VSW_SIZE_CONSTRAINTS,
			AVG_PACK_DEV_TOLERANCE,
			MAX_PACK_NEED_TOLERANCE,
			OVERRIDE_AVG_PACK_DEV_IND,
			OVERRIDE_MAX_PACK_NEED_IND,
			PACK_TOLERANCE_NO_MAX_STEP_IND,
			PACK_TOLERANCE_STEPPED_IND
			)
		VALUES (
			@METHODRID,
			@AVAILABLE,
			@AVAILABLEIND,
			@SIZEGROUPRID,
			@SIZECURVEGROUPRID,
			@MERCHTYPE,
			@MERCHHNRID,
			@MERCHPHRID,
			@MERCHPHLSEQ,
			@STOREFILTERRID,
			@SIZEALTERNATERID,
			@SIZECONSTRAINTRID,
			@GENCURVE_HCG_RID,
			@GENCURVE_HN_RID,
			@GENCURVE_PH_RID,
			@GENCURVE_PHL_SEQUENCE,
			@GENCURVE_COLOR_IND,
			@GENCURVE_MERCH_TYPE,
			@GENCONSTRAINT_HCG_RID,
			@GENCONSTRAINT_HN_RID,
			@GENCONSTRAINT_PH_RID,
			@GENCONSTRAINT_PHL_SEQUENCE,
			@GENCONSTRAINT_COLOR_IND,
			@GENCONSTRAINT_MERCH_TYPE,
			@NORMALIZE_SIZE_CURVES_IND,
			@FILL_SIZES_TO_TYPE,
			@USE_DEFAULT_CURVE_IND,
			@GENCURVE_NSCCD_RID,
			@APPLY_RULES_ONLY_IND,
			@IB_MERCH_TYPE,
			@IB_MERCH_HN_RID,
			@IB_MERCH_PH_RID,
			@IB_MERCH_PHL_SEQUENCE,
			@VSW_SIZE_CONSTRAINTS_IND,
			@VSW_SIZE_CONSTRAINTS,
			@AVGPACKDEVIATION,
			@MAXPACKNEED,
			@OVERRIDE_AVG_PACK_DEV_IND,
			@OVERRIDE_MAX_PACK_NEED_IND,
			@PACK_TOLERANCE_NO_MAX_STEP_IND,
			@PACK_TOLERANCE_STEPPED_IND
			)
	END
	ELSE
		--UPDATE
	BEGIN
		UPDATE METHOD_FILL_SIZE_HOLES
		SET METHOD_RID = @METHODRID,
			AVAILABLE = @AVAILABLE,
			AVAILABLE_TYPE_IND = @AVAILABLEIND,
			SIZE_GROUP_RID = @SIZEGROUPRID,
			SIZE_CURVE_GROUP_RID = @SIZECURVEGROUPRID,
			MERCH_TYPE = @MERCHTYPE,
			MERCH_HN_RID = @MERCHHNRID,
			MERCH_PH_RID = @MERCHPHRID,
			MERCH_PHL_SEQUENCE = @MERCHPHLSEQ,
			STORE_FILTER_RID = @STOREFILTERRID,
			SIZE_ALTERNATE_RID = @SIZEALTERNATERID,
			SIZE_CONSTRAINT_RID = @SIZECONSTRAINTRID,
			GENCURVE_HCG_RID = @GENCURVE_HCG_RID,
			GENCURVE_HN_RID = @GENCURVE_HN_RID,
			GENCURVE_PH_RID = @GENCURVE_PH_RID,
			GENCURVE_PHL_SEQUENCE = @GENCURVE_PHL_SEQUENCE,
			GENCURVE_COLOR_IND = @GENCURVE_COLOR_IND,
			GENCURVE_MERCH_TYPE = @GENCURVE_MERCH_TYPE,
			GENCONSTRAINT_HCG_RID = @GENCONSTRAINT_HCG_RID,
			GENCONSTRAINT_HN_RID = @GENCONSTRAINT_HN_RID,
			GENCONSTRAINT_PH_RID = @GENCONSTRAINT_PH_RID,
			GENCONSTRAINT_PHL_SEQUENCE = @GENCONSTRAINT_PHL_SEQUENCE,
			GENCONSTRAINT_COLOR_IND = @GENCONSTRAINT_COLOR_IND,
			GENCONSTRAINT_MERCH_TYPE = @GENCONSTRAINT_MERCH_TYPE,
			NORMALIZE_SIZE_CURVES_IND = @NORMALIZE_SIZE_CURVES_IND,
			FILL_SIZES_TO_TYPE = @FILL_SIZES_TO_TYPE,
			USE_DEFAULT_CURVE_IND = @USE_DEFAULT_CURVE_IND,
			GENCURVE_NSCCD_RID = @GENCURVE_NSCCD_RID, 
			APPLY_RULES_ONLY_IND = @APPLY_RULES_ONLY_IND, 			
			IB_MERCH_TYPE = @IB_MERCH_TYPE, 
			IB_MERCH_HN_RID = @IB_MERCH_HN_RID, 
			IB_MERCH_PH_RID = @IB_MERCH_PH_RID, 
			IB_MERCH_PHL_SEQUENCE = @IB_MERCH_PHL_SEQUENCE, 
			VSW_SIZE_CONSTRAINTS_IND = @VSW_SIZE_CONSTRAINTS_IND, 
			VSW_SIZE_CONSTRAINTS = @VSW_SIZE_CONSTRAINTS,
			AVG_PACK_DEV_TOLERANCE = @AVGPACKDEVIATION,
			MAX_PACK_NEED_TOLERANCE = @MAXPACKNEED,
			OVERRIDE_AVG_PACK_DEV_IND = @OVERRIDE_AVG_PACK_DEV_IND,
			OVERRIDE_MAX_PACK_NEED_IND = @OVERRIDE_MAX_PACK_NEED_IND,
			PACK_TOLERANCE_NO_MAX_STEP_IND = @PACK_TOLERANCE_NO_MAX_STEP_IND,
			PACK_TOLERANCE_STEPPED_IND = @PACK_TOLERANCE_STEPPED_IND 
		WHERE METHOD_RID = @METHODRID
	END
	SELECT @@ROWCOUNT;
	SET NOCOUNT OFF
	SET ANSI_PADDING OFF
END
GO


