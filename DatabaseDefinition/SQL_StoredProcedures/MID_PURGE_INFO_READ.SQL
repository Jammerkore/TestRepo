--dv =============================================
--dv Create date:	10/28/2013
--dv Description:	Reads purge info based on process rid
--dv History:		3/6/2015 TT#1576-MD -jsobek -Data Layer Request - Add VSW Revision Records to Purge
--dv =============================================
CREATE PROCEDURE [dbo].[MID_PURGE_INFO_READ]
	@PROCESS_RID int
AS
BEGIN
	SET NOCOUNT ON;

	SELECT 
		PROCESS_RID, 
		COALESCE(STORE_DAILY_HISTORY,0) STORE_DAILY_HISTORY,
		COALESCE(CHAIN_WEEKLY_HISTORY,0) CHAIN_WEEKLY_HISTORY,
		COALESCE(STORE_WEEKLY_HISTORY,0) STORE_WEEKLY_HISTORY,
		COALESCE(CHAIN_WEEKLY_FORECAST,0) CHAIN_WEEKLY_FORECAST,
		COALESCE(STORE_WEEKLY_FORECAST,0) STORE_WEEKLY_FORECAST,
		COALESCE(HEADERS,0) HEADERS,
		COALESCE(INTRANSIT,0) INTRANSIT,
		COALESCE(INTRANSIT_REV,0) INTRANSIT_REV,
		COALESCE(USERS,0) USERS,
		COALESCE(GROUPS,0) GROUPS,
		COALESCE(DAILY_PERCENTAGES,0) DAILY_PERCENTAGES,
		COALESCE(EMPTY_ATTRIBUTE_SETS,0) EMPTY_ATTRIBUTE_SETS,
		COALESCE(AUDITS,0) AUDITS,
		COALESCE(IMO_REV,0) IMO_REV
	FROM PURGE_INFO
	WHERE PROCESS_RID = @PROCESS_RID
			
END
GO
