CREATE PROCEDURE [dbo].[SP_MID_SZ_ALT_MODEL_UP_INS] 
	(
	@RID INT,
	@NAME VARCHAR(50),
	@PRIMSIZECURVERID INT,
	@ALTSIZECURVERID INT,
	@NEWRID INT OUTPUT
	)
AS
BEGIN
	SET NOCOUNT ON
	SET ANSI_PADDING ON

	/*****************************************************************************************/
	/* CREATED: 5/05/2005 - Steve Todd                                                       */
	/* PURPOSE: INSERTS OR UPDATES DATA IN SIZE_ALTERNATE_MODEL table                        */
	/*****************************************************************************************/
	IF NOT EXISTS (
			SELECT *
			FROM SIZE_ALTERNATE_MODEL
			WHERE SIZE_ALTERNATE_RID = @RID
			)
		--INSERT
	BEGIN
		INSERT INTO SIZE_ALTERNATE_MODEL (
			SIZE_ALTERNATE_NAME,
			PRIMARY_SIZE_CURVE_RID,
			ALTERNATE_SIZE_CURVE_RID
			)
		VALUES (
			@NAME,
			@PRIMSIZECURVERID,
			@ALTSIZECURVERID
			)

		SELECT @NEWRID = SCOPE_IDENTITY() -- TT#3256 - JSmith - Replace @@IDENTITY with SCOPE_IDENTITY()
	END
	ELSE
		--UPDATE
	BEGIN
		UPDATE SIZE_ALTERNATE_MODEL
		SET SIZE_ALTERNATE_NAME = @NAME,
			PRIMARY_SIZE_CURVE_RID = @PRIMSIZECURVERID,
			ALTERNATE_SIZE_CURVE_RID = @ALTSIZECURVERID
		WHERE SIZE_ALTERNATE_RID = @RID

		SELECT @NEWRID = @RID
	END

	SET NOCOUNT OFF
	SET ANSI_PADDING OFF
END
GO


