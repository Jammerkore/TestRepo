--dv =============================================
--dv Create date:	01/28/2014
--dv Description:	Reads a Velocity Method
--dv History: 7/21/2014 TT#855-MD && TT#1246-MD -jsobek -Velocity Enhancements
--dv =============================================
CREATE PROCEDURE [dbo].[MID_METHOD_VELOCITY_READ]
	@METHOD_RID int
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @UndefinedCalendarDateRange INT = 1;

	SELECT 
		COALESCE(SG_RID, -1) SG_RID,
		COALESCE(OTS_PLAN_HN_RID, -1) OTS_PLAN_HN_RID,
		COALESCE(OTS_PLAN_PH_RID, -1) OTS_PLAN_PH_RID,
		COALESCE(OTS_PLAN_PHL_SEQUENCE, 0) OTS_PLAN_PHL_SEQUENCE,
		COALESCE(SIM_STORE_IND, '0') SIM_STORE_IND,
		COALESCE(AVG_USING_CHAIN_IND, '1') AVG_USING_CHAIN_IND,
		COALESCE(SHIP_USING_BASIS_IND, '1') SHIP_USING_BASIS_IND,
		COALESCE(TREND_PERCENT, '0') TREND_PERCENT,
		COALESCE(BALANCE_IND, '0') BALANCE_IND,   
		COALESCE(APPLY_MIN_MAX_IND, 'N') APPLY_MIN_MAX_IND, 
		COALESCE(RECONCILE_IND, '0') RECONCILE_IND,
		COALESCE(INVENTORY_IND, 'A') INVENTORY_IND,
		COALESCE(MERCH_HN_RID, -1) MERCH_HN_RID,
		COALESCE(MERCH_PH_RID, -1) MERCH_PH_RID,
		COALESCE(MERCH_PHL_SEQUENCE, 0) MERCH_PHL_SEQUENCE,  
		COALESCE(OTS_BEGIN_CDR_RID, @UndefinedCalendarDateRange) OTS_BEGIN_CDR_RID,
		COALESCE(OTS_SHIP_TO_CDR_RID, @UndefinedCalendarDateRange) OTS_SHIP_TO_CDR_RID,
		GRADE_VARIABLE_TYPE, 
		BALANCE_TO_HEADER_IND
    FROM METHOD_VELOCITY 
	WHERE METHOD_RID = @METHOD_RID

END
GO