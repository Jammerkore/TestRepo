CREATE PROCEDURE [dbo].[SP_MID_SIZE_GROUP_DELETE] 
	@SIZE_GROUP_RID INT
AS
BEGIN
	SET NOCOUNT ON;
	-- remove size group reference from tables 
	UPDATE SIZE_CONSTRAINT_MODEL
	WITH (ROWLOCK)

	SET SIZE_GROUP_RID = 1
	WHERE SIZE_GROUP_RID = @SIZE_GROUP_RID

	UPDATE METHOD_SIZE_NEED
	WITH (ROWLOCK)

	SET SIZE_GROUP_RID = 1
	WHERE SIZE_GROUP_RID = @SIZE_GROUP_RID

	UPDATE METHOD_FILL_SIZE_HOLES
	WITH (ROWLOCK)

	SET SIZE_GROUP_RID = 1
	WHERE SIZE_GROUP_RID = @SIZE_GROUP_RID

	UPDATE METHOD_SIZE_BASIS_ALLOCATION
	WITH (ROWLOCK)

	SET SIZE_GROUP_RID = 1
	WHERE SIZE_GROUP_RID = @SIZE_GROUP_RID

	/* Begin TT#155 - JScott - Add Size Curve info to Node Properties */
	UPDATE NODE_SIZE_CURVE_CRITERIA_DETAIL
	WITH (ROWLOCK)

	SET SIZE_GROUP_RID = NULL
	WHERE SIZE_GROUP_RID = @SIZE_GROUP_RID

	/* End TT#155 - JScott - Add Size Curve info to Node Properties */
	UPDATE HEADER
	WITH (ROWLOCK)

	SET SIZE_GROUP_RID = 1
	WHERE SIZE_GROUP_RID = @SIZE_GROUP_RID

	UPDATE SIZE_CURVE_GROUP
	WITH (ROWLOCK)

	SET DEFINED_SIZE_GROUP_RID = 1
	WHERE DEFINED_SIZE_GROUP_RID = @SIZE_GROUP_RID

	-- delete tables 
	DELETE SIZE_GROUP_JOIN
	WITH (ROWLOCK)
	WHERE SIZE_GROUP_RID = @SIZE_GROUP_RID

	DELETE SIZE_GROUP
	WITH (ROWLOCK)
	WHERE SIZE_GROUP_RID = @SIZE_GROUP_RID
	SELECT @@ROWCOUNT;
END
GO


