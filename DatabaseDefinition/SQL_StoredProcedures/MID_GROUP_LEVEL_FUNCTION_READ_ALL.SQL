--dv =============================================
--dv Create date: 2/10/2014
--dv Description: Reads group level functions from the method
--dv =============================================
CREATE PROCEDURE [dbo].[MID_GROUP_LEVEL_FUNCTION_READ_ALL]
	@METHOD_RID int
AS
BEGIN
	SET NOCOUNT ON;

	SELECT 
		glf.SGL_RID, 
		SGL_SEQUENCE, 
		COALESCE(DEFAULT_IND,'0') DEFAULT_IND,
		COALESCE(PLAN_IND,'0') PLAN_IND,
		COALESCE(USE_DEFAULT_IND,'0') USE_DEFAULT_IND,
		COALESCE(CLEAR_IND,'0') CLEAR_IND,
		COALESCE(SEASON_IND,'0') SEASON_IND,
		COALESCE(SEASON_HN_RID,0) SEASON_HN_RID, 
		GLFT_ID, 
		GLSB_ID,
		COALESCE(LY_ALT_IND,'0') LY_ALT_IND,
		COALESCE(TREND_ALT_IND,'0') TREND_ALT_IND,
		COALESCE(TY_EQUALIZE_WEIGHT_IND,'0') TY_EQUALIZE_WEIGHT_IND,
		COALESCE(LY_EQUALIZE_WEIGHT_IND,'0') LY_EQUALIZE_WEIGHT_IND,
        COALESCE(APPLY_EQUALIZE_WEIGHT_IND,'0') APPLY_EQUALIZE_WEIGHT_IND,
        COALESCE(PROJECT_CURR_WEEK_SALES_IND,'0') PROJECT_CURR_WEEK_SALES_IND
	FROM GROUP_LEVEL_FUNCTION glf, 
		 STORE_GROUP_LEVEL sgl
	WHERE METHOD_RID = @METHOD_RID
		  AND glf.SGL_RID = sgl.SGL_RID
	ORDER BY SGL_SEQUENCE, DEFAULT_IND DESC, USE_DEFAULT_IND DESC

END
GO