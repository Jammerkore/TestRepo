CREATE PROCEDURE [dbo].[SP_MID_METHOD_INSERT] 
	(
	@METHOD_NAME VARCHAR(50),
	@METHOD_TYPE_ID INT,
	-- Begin TT#523 - JScott - Duplicate folder when new folder added
	@PROFILE_TYPE_ID INT,
	-- End TT#523 - JScott - Duplicate folder when new folder added
	@USER_RID INT,
	@METHOD_DESCRIPTION VARCHAR(250),
	@SG_RID INT,
	@VIRTUAL_IND CHAR,
	@METHOD_STATUS INT,
	@CUSTOM_OLL_RID INT,
	@TEMPLATE_IND char(1),
	@METHOD_RID INT OUTPUT
	)
AS
BEGIN
	SET NOCOUNT ON

	-- Begin TT#523 - JScott - Duplicate folder when new folder added
	--	INSERT INTO METHOD(METHOD_NAME, METHOD_TYPE_ID, USER_RID, METHOD_DESCRIPTION, SG_RID, VIRTUAL_IND, METHOD_STATUS, CUSTOM_OLL_RID)
	--		VALUES (@METHOD_NAME, @METHOD_TYPE_ID, @USER_RID, @METHOD_DESCRIPTION, @SG_RID, @VIRTUAL_IND, @METHOD_STATUS, @CUSTOM_OLL_RID);
	INSERT INTO METHOD (
		METHOD_NAME,
		METHOD_TYPE_ID,
		PROFILE_TYPE_ID,
		USER_RID,
		METHOD_DESCRIPTION,
		SG_RID,
		VIRTUAL_IND,
		METHOD_STATUS,
		CUSTOM_OLL_RID,
		TEMPLATE_IND
		)
	VALUES (
		@METHOD_NAME,
		@METHOD_TYPE_ID,
		@PROFILE_TYPE_ID,
		@USER_RID,
		@METHOD_DESCRIPTION,
		@SG_RID,
		@VIRTUAL_IND,
		@METHOD_STATUS,
		@CUSTOM_OLL_RID,
		@TEMPLATE_IND
		);

	-- End TT#523 - JScott - Duplicate folder when new folder added
	SELECT @METHOD_RID = SCOPE_IDENTITY() -- TT#3256 - JSmith - Replace @@IDENTITY with SCOPE_IDENTITY()
END;
GO


