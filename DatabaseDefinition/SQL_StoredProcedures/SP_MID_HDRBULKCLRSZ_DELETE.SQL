CREATE PROCEDURE [dbo].[SP_MID_HDRBULKCLRSZ_DELETE] 
	@HDR_BC_RID INT,
	@SIZE_CODE_RID INT
AS
BEGIN
	SET NOCOUNT ON;
	DECLARE @HDR_BCSZ_TBL TABLE (HDR_BCSZ_KEY INT)

	INSERT INTO @HDR_BCSZ_TBL
	SELECT HDR_BCSZ_KEY
	FROM dbo.HEADER_BULK_COLOR_SIZE
	WHERE HDR_BC_RID = @HDR_BC_RID
		AND SIZE_CODE_RID = @SIZE_CODE_RID

	DELETE BULK_COLOR_SIZE_ALLOCATION
	WITH (ROWLOCK)
	WHERE HDR_BC_RID = @HDR_BC_RID
		AND HDR_BCSZ_KEY IN (
			SELECT *
			FROM @HDR_BCSZ_TBL
			)

	DELETE HEADER_BULK_COLOR_SIZE
	WITH (ROWLOCK)
	WHERE HDR_BC_RID = @HDR_BC_RID
		AND HDR_BCSZ_KEY IN (
			SELECT *
			FROM @HDR_BCSZ_TBL
			)

	SELECT @@ROWCOUNT;
END
GO


