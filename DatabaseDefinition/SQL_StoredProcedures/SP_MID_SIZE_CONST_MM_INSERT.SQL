CREATE PROCEDURE [dbo].[SP_MID_SIZE_CONST_MM_INSERT] 
	(
	@SIZECONSTRAINTRID INT,
	@SGLRID INT,
	@COLORCODERID INT,
	@SIZESRID INT,
	@SIZECODERID INT,
	@MIN INT = NULL,
	@MAX INT = NULL,
	@MULT INT = NULL,
	@ROWTYPEID INT,
	@DIMENSIONS_RID INT
	)
AS
BEGIN
	SET NOCOUNT ON
	SET ANSI_PADDING ON

	/*****************************************************************************************/
	/* CREATED: 7/01/2004 - JEFF SCHNIERLE                                                   */
	/* PURPOSE: INSERTS OR UPDATES DATA IN SIZE_MTH_CONST_MINMAX		                 */
	/*****************************************************************************************/
	/*
	SP_HELP SIZE_MTH_CONST_MINMAX
	SP_HELP SIZE_MTH_CONST_GRPLVL
	SELECT * FROM SIZE_MTH_CONST_MINMAX
*/
	IF NOT EXISTS (
			SELECT *
			FROM SIZE_CONSTRAINT_MINMAX
			WHERE SIZE_CONSTRAINT_RID = @SIZECONSTRAINTRID
				AND SGL_RID = @SGLRID
				AND COLOR_CODE_RID = @COLORCODERID
				AND SIZES_RID = @SIZESRID
				AND DIMENSIONS_RID = @DIMENSIONS_RID
				AND ROW_TYPE_ID = @ROWTYPEID
				AND SIZE_CODE_RID = @SIZECODERID
			)
		--INSERT
	BEGIN
		INSERT INTO SIZE_CONSTRAINT_MINMAX (
			ROW_TYPE_ID,
			SIZE_CONSTRAINT_RID,
			SGL_RID,
			COLOR_CODE_RID,
			SIZES_RID,
			SIZE_CODE_RID,
			SIZE_MIN,
			SIZE_MAX,
			SIZE_MULT,
			DIMENSIONS_RID
			)
		VALUES (
			@ROWTYPEID,
			@SIZECONSTRAINTRID,
			@SGLRID,
			@COLORCODERID,
			@SIZESRID,
			@SIZECODERID,
			@MIN,
			@MAX,
			@MULT,
			@DIMENSIONS_RID
			)
	END
	ELSE
	BEGIN
		UPDATE SIZE_CONSTRAINT_MINMAX
		SET SIZE_MIN = @MIN,
			SIZE_MAX = @MAX, -- TT#2190 - JSmith - trying to determine where Max value is coming from in a model
			SIZE_MULT = @MULT -- TT#2190 - JSmith - trying to determine where Max value is coming from in a model
		WHERE SIZE_CONSTRAINT_RID = @SIZECONSTRAINTRID
			AND SGL_RID = @SGLRID
			AND COLOR_CODE_RID = @COLORCODERID
			AND SIZES_RID = @SIZESRID
			AND DIMENSIONS_RID = @DIMENSIONS_RID
			AND ROW_TYPE_ID = @ROWTYPEID
			AND SIZE_CODE_RID = @SIZECODERID
	END
	SELECT @@ROWCOUNT;
	SET NOCOUNT OFF
	SET ANSI_PADDING OFF
END
GO


