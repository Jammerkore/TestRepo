CREATE PROCEDURE [dbo].[SP_MID_ST_FOR_WK9_READ]
@dt MID_ST_FOR_WK_READ_TYPE READONLY
AS
SET NOCOUNT ON
       SELECT sfw.HN_RID, sfw.FV_RID, sfw.TIME_ID, sfw.ST_RID, COALESCE(sfw.SALES, 0) SALES, 
          COALESCE(sfw.SALES_REG, 0) SALES_REG, COALESCE(sfw.SALES_PROMO, 0) SALES_PROMO, COALESCE(sfw.SALES_MKDN, 0) SALES_MKDN, 
          COALESCE(sfw.STOCK, 0) STOCK, COALESCE(sfw.STOCK_REG, 0) STOCK_REG, COALESCE(sfw.STOCK_MKDN, 0) STOCK_MKDN, 
          COALESCE(sfw.IN_STOCK_SALES, 0) IN_STOCK_SALES, COALESCE(sfw.IN_STOCK_SALES_REG, 0) IN_STOCK_SALES_REG, 
          COALESCE(sfw.IN_STOCK_SALES_PROMO, 0) IN_STOCK_SALES_PROMO, COALESCE(sfw.IN_STOCK_SALES_MKDN, 0) IN_STOCK_SALES_MKDN, 
          COALESCE(sfw.ACCUM_SELL_THRU_SALES, 0) ACCUM_SELL_THRU_SALES, COALESCE(sfw.ACCUM_SELL_THRU_STOCK, 0) ACCUM_SELL_THRU_STOCK, 
          COALESCE(sfw.DAYS_IN_STOCK, 0) DAYS_IN_STOCK, COALESCE(sfw.RECEIVED_STOCK, 0) RECEIVED_STOCK
          
		FROM @dt xml
	JOIN VW_STORE_FORECAST_WEEK sfw ON xml.HN_MOD = sfw.HN_MOD AND xml.HN_RID = sfw.HN_RID
		AND sfw.FV_RID = xml.FV_RID
		AND sfw.TIME_ID = xml.TIME_ID
	OPTION (MAXDOP 1)


GO


