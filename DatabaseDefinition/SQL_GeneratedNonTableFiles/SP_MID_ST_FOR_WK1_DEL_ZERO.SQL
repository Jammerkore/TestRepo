if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[SP_MID_ST_FOR_WK1_DEL_ZERO]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
drop procedure [dbo].[SP_MID_ST_FOR_WK1_DEL_ZERO]
GO
 
CREATE PROCEDURE [dbo].[SP_MID_ST_FOR_WK1_DEL_ZERO]
@COMMIT_LIMIT INT,
@RECORDS_DELETED int output
AS


DELETE top (@COMMIT_LIMIT) from STORE_FORECAST_WEEK1
          WHERE COALESCE(SALES, 0) = 0 AND COALESCE(SALES_REG, 0) = 0 AND COALESCE(SALES_PROMO, 0) = 0 AND 
          COALESCE(SALES_MKDN, 0) = 0 AND COALESCE(STOCK, 0) = 0 AND COALESCE(STOCK_REG, 0) = 0 AND 
          COALESCE(STOCK_MKDN, 0) = 0 AND COALESCE(IN_STOCK_SALES, 0) = 0 AND COALESCE(IN_STOCK_SALES_REG, 0) = 0 AND 
          COALESCE(IN_STOCK_SALES_PROMO, 0) = 0 AND COALESCE(IN_STOCK_SALES_MKDN, 0) = 0 AND 
          COALESCE(ACCUM_SELL_THRU_SALES, 0) = 0 AND COALESCE(ACCUM_SELL_THRU_STOCK, 0) = 0 AND 
          COALESCE(DAYS_IN_STOCK, 0) = 0 AND COALESCE(RECEIVED_STOCK, 0) = 0
set @RECORDS_DELETED = @@rowcount


GO


