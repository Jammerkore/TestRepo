if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[SP_MID_CHN_FOR_WK_DEL_ZERO]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
drop procedure [dbo].[SP_MID_CHN_FOR_WK_DEL_ZERO]
GO
 
CREATE PROCEDURE [dbo].[SP_MID_CHN_FOR_WK_DEL_ZERO]
@COMMIT_LIMIT INT,
@RECORDS_DELETED int output
AS


DELETE top (@COMMIT_LIMIT) from CHAIN_FORECAST_WEEK
          WHERE COALESCE(SALES, 0) = 0 AND COALESCE(SALES_REG, 0) = 0 AND COALESCE(SALES_PROMO, 0) = 0 AND 
          COALESCE(SALES_MKDN, 0) = 0 AND COALESCE(STOCK, 0) = 0 AND COALESCE(STOCK_REG, 0) = 0 AND 
          COALESCE(STOCK_MKDN, 0) = 0 AND COALESCE(WOS, 0) = 0 AND COALESCE(WOS_REGPROMO, 0) = 0
          
set @RECORDS_DELETED = @@rowcount




GO


