--dv Create date: 5/3/2013
--dv Description:	Builds the node description as shown in the merchandise hierarchy
--dv Future Design Considerations: Build the COLOR_DISPLAY_ID into the COLOR_NODE table (slower writes, but faster reads)
--dv =============================================
CREATE FUNCTION [dbo].[UDF_HIERARCHY_BUILD_COLOR_NODE_DISPLAY_ID]
(
	@PHL_DISPLAY_OPTION_ID int,  --defined in PRODUCT_HIERARCHY_LEVELS (joined on PHL_SEQUENCE=HIERARCHY_NODE.HOME_LEVEL)
	@COLOR_CODE_ID varchar(50),  --defined in COLOR_CODE
	@COLOR_CODE_NAME varchar(250), --defined in COLOR_CODE
	@COLOR_DESCRIPTION varchar(250) --defined in COLOR_NODE
)
RETURNS varchar(556)  --Max Case: @COLOR_CODE_ID(50) + @COLOR_CODE_NAME(250) + @COLOR_DESCRIPTION(250) + 6 separator characters
AS
BEGIN
	DECLARE @COLOR_DISPLAY_ID varchar(103)
	SET @COLOR_DESCRIPTION = coalesce(@COLOR_DESCRIPTION, '')

	IF (@PHL_DISPLAY_OPTION_ID = 800700) --NameOnly
		BEGIN
			SET @COLOR_DISPLAY_ID = RTRIM(@COLOR_CODE_NAME)
		END
	ELSE IF (@PHL_DISPLAY_OPTION_ID = 800701) --IdOnly
		BEGIN
			SET @COLOR_DISPLAY_ID = RTRIM(@COLOR_CODE_ID)
		END
	ELSE IF (@PHL_DISPLAY_OPTION_ID = 800702) --DescriptionOnly
		BEGIN
			SET @COLOR_DISPLAY_ID = RTRIM(@COLOR_DESCRIPTION)
		END
	ELSE IF (@PHL_DISPLAY_OPTION_ID = 800703) --IdAndName
		BEGIN
			SET @COLOR_DISPLAY_ID = RTRIM(@COLOR_CODE_ID) + ' [' + RTRIM(@COLOR_CODE_NAME) + ']'
		END
	ELSE IF (@PHL_DISPLAY_OPTION_ID = 800704) --IdAndDescription
		BEGIN
			SET @COLOR_DISPLAY_ID = RTRIM(@COLOR_CODE_ID) +  ' [' + RTRIM(@COLOR_DESCRIPTION) + ']'
		END
	ELSE IF (@PHL_DISPLAY_OPTION_ID = 800705) --NameAndDescription
		BEGIN
			SET @COLOR_DISPLAY_ID = RTRIM(@COLOR_CODE_NAME) + ' [' + RTRIM(@COLOR_DESCRIPTION) + ']'
		END
	ELSE IF (@PHL_DISPLAY_OPTION_ID = 800706) --IdAndNameAndDesc
		BEGIN
			SET @COLOR_DISPLAY_ID = RTRIM(@COLOR_CODE_ID) +  ' [' +  RTRIM(@COLOR_CODE_NAME) + ']' + ' [' + RTRIM(@COLOR_DESCRIPTION) + ']'
		END
	ELSE IF (@PHL_DISPLAY_OPTION_ID = 800707) --DoNotDisplay
		BEGIN
			SET @COLOR_DISPLAY_ID = ''
		END
	ELSE
		BEGIN
			SET @COLOR_DISPLAY_ID = RTRIM(@COLOR_CODE_ID) + ' [' + RTRIM(@COLOR_CODE_NAME) + ']'
		END


	RETURN @COLOR_DISPLAY_ID

END
GO
