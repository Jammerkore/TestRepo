/*RELEASE 5.2.1.9 01-17-2014 TT#3465-M-VStuart-Size Day to Week Summary Audit not Purging correctly-MID */
BEGIN
	/* Delete orphans in SIZE_DAY_TO_WEEK_SUMMARY_INFO. */
	DELETE
	FROM SIZE_DAY_TO_WEEK_SUMMARY_INFO
	WHERE (
			PROCESS_RID NOT IN (
				SELECT PROCESS_RID
				FROM PROC_HDR AS ph
				)
			)
END
GO

if not exists (select * from INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE TABLE_NAME='SIZE_DAY_TO_WEEK_SUMMARY_INFO' AND CONSTRAINT_NAME='PROC_HDR_SIZE_DAY_TO_WEEK_SUMMARY_INFO_FK1')
BEGIN
	/* Add a Foreign Key constraint to the SIZE_DAY_TO_WEEK_SUMMARY_INFO table. */
	ALTER TABLE [dbo].[SIZE_DAY_TO_WEEK_SUMMARY_INFO] ADD CONSTRAINT PROC_HDR_SIZE_DAY_TO_WEEK_SUMMARY_INFO_FK1 FOREIGN KEY (PROCESS_RID) REFERENCES [dbo].[PROC_HDR] (PROCESS_RID)
END
GO
