/* RELEASE 5.3.0.6 05-06-2013 -TT#708-MD -stodd - Group Allocation Security  */
/* Backout incorrect security */
DELETE FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 827115 and ACTION_ID = 801160;
DELETE FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 827115 and ACTION_ID = 801161;   --       : Maintain
DELETE FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 827115 and ACTION_ID = 801162;  --       : Delete
DELETE FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 827115 and ACTION_ID = 801163;   --       : View

DELETE FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 827215 and ACTION_ID = 801160;--User Group Allocation Review : Full Control
DELETE FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 827215 and ACTION_ID = 801161;   --       : Maintain
DELETE FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 827215 and ACTION_ID = 801162;   --       : Delete
DELETE FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 827215 and ACTION_ID = 801163;   --       : View

DELETE FROM SECURITY_FUNCTION_JOIN where FUNC_ID = 827115 and FUNC_TYPE = 0 and FUNC_LEVEL = 3 and FUNC_PARENT = 827100;
DELETE FROM SECURITY_FUNCTION_JOIN where FUNC_ID = 827115 and FUNC_TYPE = 0 and FUNC_LEVEL = 3 and FUNC_PARENT = 827200; 
GO

/* new security */
IF NOT EXISTS(SELECT * FROM SECURITY_FUNCTION_JOIN where FUNC_ID = 826500)
BEGIN
   INSERT INTO SECURITY_FUNCTION_JOIN(FUNC_ID, FUNC_TYPE, FUNC_LEVEL, FUNC_PARENT) VALUES(826500, 1, 2, 826000);   --Group Allocation
END
GO

IF NOT EXISTS(SELECT * FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 826500 AND ACTION_ID = 801160)
BEGIN
   INSERT INTO SECURITY_FUNCTION_ACTIONS(FUNC_ID, ACTION_ID) VALUES(826500, 801160);   --Group Allocation : Full Control
END
GO

IF NOT EXISTS(SELECT * FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 826500 AND ACTION_ID = 801161)
BEGIN
   INSERT INTO SECURITY_FUNCTION_ACTIONS(FUNC_ID, ACTION_ID) VALUES(826500, 801161);   --     : Maintain
END
GO

IF NOT EXISTS(SELECT * FROM SECURITY_FUNCTION_ACTIONS where FUNC_ID = 826500 AND ACTION_ID = 801163)
BEGIN
   INSERT INTO SECURITY_FUNCTION_ACTIONS(FUNC_ID, ACTION_ID) VALUES(826500, 801163);   --     : View
END
GO