CREATE FUNCTION [dbo].[UDF_MID_TRANSPOSE_NODE_PURGE_DATES]
()
   RETURNS @t TABLE (HN_RID int, PURGE_HEADERS_WEEKS_RECEIPT int, PURGE_HEADERS_WEEKS_ASN int, PURGE_HEADERS_WEEKS_DUMMY int, PURGE_HEADERS_WEEKS_DROPSHIP int,
   PURGE_HEADERS_WEEKS_RESERVE int, PURGE_HEADERS_WEEKS_WORKUPTOTALBUY int, PURGE_HEADERS_WEEKS_PO int, PURGE_HEADERS_WEEKS_VSW int)
 AS
 BEGIN
 insert @t
 SELECT 
    HN_RID, 
    MAX(CASE WHEN HEADER_TYPE=800730 THEN PURGE_HEADERS END) AS PURGE_HEADERS_WEEKS_RECEIPT,
    MAX(CASE WHEN HEADER_TYPE=800731 THEN PURGE_HEADERS END) AS PURGE_HEADERS_WEEKS_ASN,
    MAX(CASE WHEN HEADER_TYPE=800732 THEN PURGE_HEADERS END) AS PURGE_HEADERS_WEEKS_DUMMY,
    MAX(CASE WHEN HEADER_TYPE=800733 THEN PURGE_HEADERS END) AS PURGE_HEADERS_WEEKS_DROPSHIP,
    MAX(CASE WHEN HEADER_TYPE=800735 THEN PURGE_HEADERS END) AS PURGE_HEADERS_WEEKS_RESERVE,
    MAX(CASE WHEN HEADER_TYPE=800737 THEN PURGE_HEADERS END) AS PURGE_HEADERS_WEEKS_WORKUPTOTALBUY,
    MAX(CASE WHEN HEADER_TYPE=800738 THEN PURGE_HEADERS END) AS PURGE_HEADERS_WEEKS_PO,
    MAX(CASE WHEN HEADER_TYPE=800741 THEN PURGE_HEADERS END) AS PURGE_HEADERS_WEEKS_VSW
FROM PURGE_CRITERIA_HEADER_PURGE
GROUP BY HN_RID
 RETURN
 END

GO
